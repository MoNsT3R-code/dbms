create database musfiradblab11;
use musfiradblab11;

create table Programs

	(
	ProgramName varchar(255) Primary key,
	Duration float,
	);

insert into Programs(ProgramName, Duration) values

	('BSCS', 2),
	('BA', 2),
	('BBA', 4),
	('MBA', 1.5),
	('MCS', 2),
	('MA', 1.5);

create table Faculty

	(
	FacID	varchar(255) Primary key,
	FirstName varchar(255),
	LastName varchar(255),	
	Specialization varchar(255)
	);

insert into Faculty(FacID, FirstName, LastName, Specialization) values
	
	('F001', 'Sarwan', 'Abbasi', 'Human Computer Interaction'),
	('F002', 'Winter', 'Halloween', 'Artificial Intelligence'),
	('F003', 'Sarmad', 'Abbasi', 'Algorithms'),
	('F004', 'Salman', 'Chaudhry', 'Operating Systems'),
	('F005', 'Sarah', 'Aslam', 'Software Engineering'),
	('F006', 'Rauf', 'Butt', 'Mechatronics'),
	('F007', 'Muhammad', 'Ijaz', 'Pakistan History'),
	('F008', 'Khizer', 'Javaid', 'Mechanics'),
	('F009', 'Samiya', 'Ayub', 'Statistics'),
	('F010', 'Asim', 'Nadeem', 'Algebra'),
	('F011', 'Farheen', 'Saeed','Mass Communication'),
	('F012', 'Anum', 'Abid', 'Mass Communication'),
	('F013', 'Ahmed', 'Iqbal', 'English Literature'),
	('F014', 'Rabia', 'Wasif', 'English Literature'),
	('F015', 'Muhammad', 'Habib', 'Micro Economics'),
	('F016', 'Muhammad', 'Khan', 'Macro Economics'),
	('F017', 'Zeeshan', 'Bhutta', 'Management'),
	('F018', 'Muhammad', 'Ahmed', 'Management'),
	('F019', 'Irtifa', 'Nasir', 'Marketing');

create table Student

	(
    StdID varchar(255) Primary key,
    FirstName varchar(255),
    LastName varchar(255),
    Gender varchar(255),
    PrgID varchar(255),
    EnrollSemester varchar(255),
    EnrollYear int,
    Foreign key (PrgID) references Programs(ProgramName)
	);

insert into Student(StdID, FirstName, LastName, Gender, PrgID, EnrollSemester, EnrollYear) values

	('S001', 'Ab', 'Rehman', 'M', 'BSCS', 'Spring', 2014),
	('S002', 'Alizeh', 'Hawking', 'F', 'BA', 'Fall', 2016),
	('S003', 'Saad', 'Stephen', 'M', 'BSCS', 'Fall', 2014),
	('S004',	'Shozab',	'Khan','M',	'BBA',	'Spring',	2015),
	('S005',	'Bingo',	'Nirvana',	'F',	'MCS',	'Fall',	2016),
	('S006',	'Nehal',	'Shawshank',	'F',	'MBA',	'Spring',	2014),
	('S007',	'Sohaib',	'Dada',	'M',	'MBA',	'Fall',	2015),
	('S008',	'Zainab',	'Ashfaq',	'F',	'BA','Fall',	2016),
	('S009',	'Emmanuelle',	'Khan',	'F',	'BSCS',	'Spring',	2017),
	('S010',	'Zeeshan',	'Stone',	'M',	'MBA',	'Fall',	2016),
	('S011',	'Bulbulay','Kumar',	'M',	'MA',	'Fall',	2016),
	('S012',	'Ayesha',	'Abid',	'F','BBA', 'Spring',	2016),
	('S013',	'Fatima',	'Ijaz',	'F',	'BBA', 'Spring',	2016),
	('S014',	'Ali',	'Jaffery','M',	'BBA',	'Fall',2013),
	('S015',	'Qasim',	'Abid',	'M',	'BA', 'Spring',	2015),
	('S016',	'Babak',	'Ashfaq',	'M',	'BA',	'Fall',	2016),
	('S017','Sakina',	'Abbas',	'F',	'BA',	'Fall',	2015),
	('S018',	'Ailia',	'Zahra',	'F',	'MBA',	'Spring',	2014),
	('S019',	'Usman',	'Ilyas',	'M',	'MBA',	'Fall',	2014),
	('S020',	'Amina',	'Hussain',	'F',	'MBA',	'Spring',	2014),
	('S021',	'Momina',	'Qureshi',	'F',	'MCS',	'Fall',	2014),
	('S022',	'Christoper',	'Emmanuelle',	'M',	'MCS',	'Spring',	2015),
	('S023', 'Ali', 'Malik', 'M', 'MCS', 'Fall', 2015);

create table Course
(
    CrseID varchar(255) primary key,
    CourseName varchar(255) ,
    Program varchar(255) ,
    foreign key (Program) references Programs(ProgramName)
);


insert into Course (CrseID, CourseName, Program) values
	
	('COMP213', 'Database Systems', 'BSCS'),
	('COMP303', 'Algorithms', 'BSCS'),
	('COMP302', 'Theory of Automata', 'BSCS'),
	('ENGL101', 'Basic Writing Skills', 'ALL'),
	('ENGL103', 'Advanced Writing Skills', 'ALL'),
	('BUSN121', 'Micro Economics', 'BBA'),
	('MCOM100', 'Intro to Mass Communication', 'ALL'),
	('MCOM301', 'Press Laws And Ethics', 'BA'),
	('BUSN554', 'Entrepreneurship', 'MBA'),
	('BUSN565', 'Advanced Marketing Skills', 'MBA'),
	('COMP788', 'Quantum Computing', 'MCS'),	
	('COMP650', 'Digital Signal Processing', 'MCS'),
	('MATHS100', 'Basic Mathematics', 'ALL'),
	('MATHS103', 'Calculus', 'ALL'),
	('PHYS101', 'Intro to Physics', 'ALL'),
	('PHYS103', 'Intro to Physics II', 'ALL'),
	('ENGL315', 'Poetry I', 'BA'),
	('ENGL313', 'Sociolinguistics', 'BA'),
	('BUSN322', 'Financial Management', 'BBA'),
	('BUSN361', 'Ops Excellence', 'BBA'),
	('BUSN460', 'Business Law', 'BBA'),
	('BUSN305', 'Corporate Governance', 'BBA'),
	('COMP111', 'Programming II', 'BSCS'),
	('COMP220', 'Software Engineering', 'BSCS'),
	('COMP301', 'Operating Systems', 'BSCS'),
	('COMP323', 'Computer Organization', 'BSCS'),
	('COMP660', 'Advanced AI', 'MCS'),
	('CSCS100', 'Intro to Computing', 'ALL'),
	('STAT101', 'Basic Statistics', 'ALL');


create table COURSESECTION

	(
    CrseSecID varchar(255) primary key,
    CrseID varchar(255),
    Semester varchar(255),
    FacID varchar(255),
    Section varchar(255),
    Room varchar(255),
    foreign key (CrseID) references Course(CrseID),
    foreign key (FacID) references Faculty(FacID)
	);

insert into COURSESECTION (CrseSecID, CrseID, Semester, FacID, Section, Room) values
	('CS001','COMP213','Spring 2017','F001','A','S319'),
	('CS002','COMP213','Spring 2017','F001','B','S319'),
	('CS003','COMP303','Spring 2017','F003','A','S218'),
	('CS004','COMP303','Spring 2017','F003','B','S316'),
	('CS005','COMP302','Spring 2017','F005','A','S317'),
	('CS006','COMP302','Spring 2017','F004','B','S216'),
	('CS007','COMP111','Fall 2017','F001','A','S317'),
	('CS008','COMP111','Fall 2017','F003','B','S218'),
	('CS009','COMP111','Fall 2017','F005','C','S219'),
	('CS010','COMP111','Fall 2017','F006','D','S319'),
	('CS011','COMP111','Fall 2017','F002','E','S218'),
	('CS012','COMP111','Fall 2017','F002','F','S219'),
	('CS013','COMP220','Fall 2017','F003','A','S319'),
	('CS014','COMP788','Spring 2017','F003','A','S320'),
	('CS015','COMP650','Spring 2017','F004','A','S219'),
	('CS016','COMP220','Fall 2017','F004','B','S212'),
	('CS017','COMP220','Fall 2017','F005','C','S212'),
	('CS018','COMP301','Fall 2017','F001','A','S316'),
	('CS019','COMP301','Fall 2017','F005','B','S319'),
	('CS020','COMP323','Fall 2017','F006','A','S215'),
	('CS021','COMP323','Fall 2017','F004','B','S215'),
	('CS022','COMP323','Fall 2017','F005','C','S316'),
	('CS023','COMP660','Fall 2017','F002','A','S215'),
	('CS024','CSCS100','Fall 2017','F002','A','S319'),
	('CS025','CSCS100','Fall 2017','F001','B','S319'),
	('CS026','CSCS100','Fall 2017','F003','C','S218'),
	('CS027','CSCS100','Fall 2017','F006','D','S320'),
	('CS028','CSCS100','Fall 2017','F005','E','S319'),
	('CS029','CSCS100','Fall 2017','F001','F','S320'),
	('CS030','ENGL101','Spring 2017','F014','A','E101'),
	('CS031','ENGL101','Spring 2017','F013','B','E104'),
	('CS032','ENGL103','Spring 2017','F013','A','E103'),
	('CS033','ENGL103','Spring 2017','F013','B','E102'),
	('CS034','ENGL315','Spring 2017','F013','A','E104'),
	('CS035','ENGL315','Spring 2017','F014','B','E101'),
	('CS036','ENGL313','Spring 2017','F014','A','E103'),
	('CS037','ENGL313','Spring 2017','F014','B','E101'),
	('CS038','PHYS101','Spring 2017','F008','A','S007'),
	('CS039','PHYS101','Spring 2017','F006','B','S009'),
	('CS040','PHYS103','Spring 2017','F008','A','S009'),
	('CS041','STAT101','Fall 2017','F009','A','S412'),
	('CS042','STAT101','Fall 2017','F009','B','S414'),
	('CS043','STAT101','Fall 2017','F009','C','S416'),
	('CS044','STAT101','Fall 2017','F009','D','S410'),
	('CS045','MCOM100','Spring 2017','F012','A','E202'),
	('CS046','MCOM100','Spring 2017','F011','B','E202'),
	('CS047','MCOM301','Spring 2017','F012','A','E204'),
	('CS048','MATHS100','Spring 2017','F010','A','S410'),
	('CS049','MATHS100','Spring 2017','F006','B','S410'),
	('CS050','MATHS103','Spring 2017','F006','A','S411'),
	('CS051','MATHS103','Spring 2017','F010','B','S418'),
	('CS052','BUSN322','Spring 2017','F019','A','E313'),
	('CS053','BUSN322','Spring 2017','F016','B','E315'),
	('CS054','BUSN361','Spring 2017','F018','A','E205'),
	('CS055','BUSN361','Spring 2017','F019','B','E221'),
	('CS057','BUSN460','Fall 2017','F017','A','E304'),
	('CS058','BUSN460','Fall 2017','F017','B','E218'),
	('CS059','BUSN305','Fall 2017','F015','A','E320'),
	('CS060','BUSN305','Fall 2017','F019','B','E108'),
	('CS061','BUSN121','Spring 2017','F015','A','E108'),
	('CS062','BUSN121','Spring 2017','F017','B','E109'),
	('CS063','BUSN554','Spring 2017','F018','A','E220'),
	('CS064','BUSN554','Spring 2017','F015','B','E218'),
	('CS065','BUSN565','Spring 2017','F015','A','E320'),
	('CS066','BUSN565','Spring 2017','F019','B','E321'),
	('CS067','COMP213','Fall 2017','F001','A','S319'),
	('CS068','COMP788','Fall 2017','F003','A','S219'),
	('CS069','COMP650','Fall 2017','F001','A','S412'),
	('CS070','COMP660','Fall 2017','F003','A','S416'),
	('CS071','BUSN121','Fall 2017','F008','A','S412'),
	('CS072','BUSN121','Fall 2017','F007','B','S319'),
	('CS073','BUSN322','Fall 2017','F007','A','S219'),
	('CS074','BUSN322','Fall 2017','F009','B','S219'),
	('CS075','BUSN361','Fall 2017','F009','A','S313'),
	('CS076','BUSN361','Fall 2017','F009','B','S219'),
	('CS077','BUSN460','Fall 2017','F008','A','S317'),
	('CS078','BUSN460','Fall 2017','F009','B','S316'),
	('CS079','BUSN305','Fall 2017','F009','A','S318'),
	('CS080','BUSN305','Fall 2017','F007','B','S217'),
	('CS081','BUSN554','Fall 2017','F007','A','S313'),
	('CS082','BUSN565','Fall 2017','F009','A','S417'),
	('CS083','ENGL313','Fall 2017','F006','A','S320'),
	('CS084','ENGL313','Fall 2017','F006','B','S319'),
	('CS085','ENGL315','Fall 2017','F006','A','S217'),
	('CS086','ENGL315','Fall 2017','F006','B','S219'),
	('CS087','MCOM301','Fall 2017','F005','A','E318'),
	('CS088','MCOM301','Fall 2017','F005','B','E317'),
	('CS089','ENGL101','Fall 2017','F006','A','E216'),
	('CS090','ENGL101','Fall 2017','F006','B','E320'),
	('CS091','ENGL103','Fall 2017','F006','A','E217'),
	('CS092','MCOM100','Fall 2017','F005','A','E320'),
	('CS093','MATHS100','Fall 2017','F010','A','S217'),
	('CS094','MATHS100','Fall 2017','F010','B','S218'),
	('CS095','MATHS103','Fall 2017','F010','A','S412'),
	('CS096','STAT101','Fall 2017','F010','A','S219'),
	('CS097','STAT101','Fall 2017','F010','B','S313'),
	('CS098','PHYS101','Fall 2017','F011','A','S320'),
	('CS099','PHYS101','Fall 2017','F011','B','S313'),
	('CS100','PHYS103','Fall 2017','F011','A','S219'),
	('CS101','CSCS100','Fall 2017','F001','A','S417'),	
	('CS102','CSCS100','Fall 2017','F002','B','S219'),
	('CS103','CSCS100','Fall 2017','F002','C','S219'),
	('CS104','CSCS100','Fall 2017','F002','D','S219');

create table StudentCourses
(
    StdID varchar(255),
    CrseSecID varchar(255),
    foreign key (StdID) references Student(StdID),
    foreign key (CrseSecID) references CourseSection(CrseSecID)
);

insert into StudentCourses (StdID, CrseSecID) values
	('S001','CS005'),
	('S001','CS009'),
	('S001','CS011'),
	('S001','CS013'),
	('S001','CS040'),
	('S001','CS054'),
	('S001','CS061'),
	('S001','CS065'),
	('S001','CS067'),
	('S001','CS102'),
	('S002','CS001'),
	('S002','CS004'),
	('S002','CS008'),
	('S002','CS014'),
	('S002','CS053'),	
	('S002','CS054'),
	('S002','CS055'),
	('S002','CS062'),
	('S002','CS065'),
	('S002','CS101'),
	('S003','CS001'),
	('S003','CS004'),
	('S003','CS006'),	
	('S003','CS011'),
	('S003','CS050'),
	('S003','CS054'),
	('S003','CS056'),
	('S003','CS060'),
	('S003','CS065'),
	('S003','CS102'),
	('S004','CS001'),
	('S004','CS008'),
	('S004','CS012'),	
	('S004','CS014'),
	('S004','CS042'),
	('S004','CS054'),
	('S004','CS057'),
	('S004','CS061'),
	('S004','CS067'),
	('S004','CS104'),
	('S005','CS001'),
	('S005','CS005'),
	('S005','CS012'),
	('S005','CS014'),
	('S005','CS050'),
	('S005','CS056'),
	('S005','CS058'),
	('S005','CS061'),
	('S005','CS065'),
	('S005','CS093'),
	('S006','CS001'),
	('S006','CS005'),
	('S006','CS008'),
	('S006','CS013'),
	('S006','CS042'),
	('S006','CS055'),
	('S006','CS058'),
	('S006','CS063'),
	('S006','CS067'),
	('S006','CS096'),
	('S007','CS001'),
	('S007','CS004'),
	('S007','CS007'),
	('S007','CS014'),
	('S007','CS046'),
	('S007','CS056'),
	('S007','CS060'),
	('S007','CS064'),
	('S007','CS067'),
	('S007','CS094'),
	('S008','CS001'),
	('S008','CS003'),
	('S008','CS006'),
	('S008','CS009'),
	('S008','CS049'),
	('S008','CS055'),
	('S008','CS060'),
	('S008','CS065'),
	('S008','CS067'),
	('S008','CS104'),
	('S009','CS018'),
	('S009','CS020'),
	('S009','CS024'),
	('S009','CS027'),
	('S009','CS050'),
	('S009','CS071'),
	('S009','CS073'),
	('S009','CS076'),
	('S009','CS079'),
	('S009','CS096'),
	('S010','CS018'),
	('S010','CS021'),
	('S010','CS025'),
	('S010','CS027'),
	('S010','CS038'),
	('S010','CS071'),
	('S010','CS075'),
	('S010','CS077'),
	('S010','CS080'),
	('S010','CS100'),
	('S011','CS018'),
	('S011','CS021'),
	('S011','CS024'),
	('S011','CS027'),
	('S011','CS050'),
	('S011','CS072'),
	('S011','CS077'),
	('S011','CS078'),
	('S011','CS080'),
	('S011','CS097'),
	('S012','CS018'),
	('S012','CS023'),
	('S012','CS026'),
	('S012','CS027'),
	('S012','CS047'),
	('S012','CS072'),
	('S012','CS074'),
	('S012','CS077'),
	('S012','CS079'),
	('S012','CS091'),
	('S013','CS018'),
	('S013','CS021'),
	('S013','CS025'),
	('S013','CS027'),
	('S013','CS050'),
	('S013','CS071'),
	('S013','CS073'),
	('S013','CS076'),
	('S013','CS079'),
	('S013','CS095'),
	('S014','CS018'),
	('S014','CS021'),
	('S014','CS025'),
	('S014','CS027'),
	('S014','CS038'),
	('S014','CS073'),
	('S014','CS077'),
	('S014','CS079'),
	('S014','CS085'),
	('S014','CS089'),
	('S015','CS032'),
	('S015','CS036'),
	('S015','CS039'),
	('S015','CS044'),
	('S015','CS052'),
	('S015','CS086'),
	('S015','CS091'),
	('S015','CS097'),
	('S015','CS103'),
	('S015','CS104'),
	('S016','CS030'),
	('S016','CS040'),
	('S016','CS044'),
	('S016','CS049'),
	('S016','CS053'),
	('S016','CS085'),
	('S016','CS094'),
	('S016','CS097'),
	('S016','CS101'),
	('S016','CS104'),
	('S017','CS034'),
	('S017','CS036'),
	('S017','CS039'),
	('S017','CS048'),
	('S017','CS053'),
	('S017','CS085'),
	('S017','CS090'),
	('S017','CS093'),
	('S017','CS095'),
	('S017','CS102'),
	('S018','CS029'),
	('S018','CS039'),
	('S018','CS047'),
	('S018','CS081'),
	('S018','CS094'),
	('S018','CS098'),
	('S019','CS029'),
	('S019','CS044'),
	('S019','CS047'),
	('S019','CS082'),
	('S019','CS100'),
	('S019','CS104'),
	('S020','CS029'),
	('S020','CS042'),
	('S020','CS048'),
	('S020','CS082'),
	('S020','CS097'),
	('S020','CS103'),
	('S021','CS016'),
	('S021','CS038'),
	('S021','CS045'),
	('S021','CS070'),
	('S021','CS095'),
	('S021','CS100'),
	('S022','CS015'),
	('S022','CS041'),
	('S022','CS047'),
	('S022','CS070'),
	('S022','CS093'),
	('S022','CS104');

select count(*) from StudentCourses SC join Students S on S.StdID = SC.StdID join CourseSection CS on CS.CrseSecID = SC.CrseSecID where S.StdName = 'Ab Rehman' and CS.Semester = 'Fall 2017';
select distinct C.CourseName from StudentCourses SC join Students S on S.StdID = SC.StdID join CourseSection CS on CS.CrseSecID = SC.CrseSecID join Course C on C.CrseID = CS.CrseID where S.StdName = 'Ab Rehman';
select distinct C.CourseName join StudentCourses SC join Students S on S.StdID = SC.StdID join CourseSection CS on CS.CrseSecID = SC.CrseSecID join Course C on C.CrseID = CS.CrseID where S.StdName = 'Ab Rehman' and CS.Semester <> 'Fall 2024';
select CrseSecID, count(*) as TotalStudents from StudentCourses group by CrseSecID order by TotalStudents desc limit 1;
select C.CrseID, C.CourseName, count(*) as TotalRegistrations from StudentCourses SC join CourseSection CS on CS.CrseSecID = SC.CrseSecID join Course C on C.CrseID = CS.CrseID group by C.CrseID, C.CourseName order by TotalRegistrations desc limit 1;
select S.StdID, S.StdName, C.CrseID, C.CourseName, COUNT(*) AS TimesTaken from StudentCourses SC join CourseSection CS on CS.CrseSecID = SC.CrseSecID join Course C on C.CrseID = CS.CrseID join Students S on S.StdID = SC.StdID group by S.StdID, S.StdName, C.CrseID, C.CourseName having count(*) > 1;
select distinct S2.StdName from StudentCourses SC1 join Students S1 on S1.StdID = SC1.StdID join StudentCourses SC2 on SC1.CrseSecID = SC2.CrseSecID join Students S2 on S2.StdID = SC2.StdID where S1.StdName in ('Momina Qureshi', 'Alizeh Irfan') and S2.StdName not in ('Momina Qureshi', 'Alizeh Irfan');
